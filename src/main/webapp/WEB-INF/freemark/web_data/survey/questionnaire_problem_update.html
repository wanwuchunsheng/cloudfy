<!DOCTYPE html>
<!--[if IE 8]> <html lang="en" class="ie8 no-js"> <![endif]-->
<!--[if IE 9]> <html lang="en" class="ie9 no-js"> <![endif]-->
<!--[if !IE]><!-->
<html lang="en" class="no-js">
<!--<![endif]-->
<!-- BEGIN HEAD -->
<head>
<title>问卷问题-修改</title>
		<link href="${resRoot}/media/odstl/css/font-awesome.min.css" rel="stylesheet" />
		<link href="${resRoot}/media/odstl/css/bootstrap.min.css" rel="stylesheet" />
		<link href="${resRoot}/media/odstl/css/uniform.default.css" rel="stylesheet" />
		<link href="${resRoot}/media/odstl/css/select2_metro.css" rel="stylesheet"  />
		<link href="${resRoot}/media/odstl/css/DT_bootstrap.css"  rel="stylesheet"  />
		<link href="${resRoot}/media/odstl/css/datepicker.css" rel="stylesheet">
		<link href="${resRoot}/media/odstl/css/datetimepicker.css" rel="stylesheet">
		<link href="${resRoot}/media/odstl/css/style-metronic.css" rel="stylesheet" />
		<link href="${resRoot}/media/odstl/css/style.css" rel="stylesheet" />
		<link href="${resRoot}/media/odstl/css/custom.css" rel="stylesheet" />

		<script src="${resRoot}/media/odstl/js/jquery-1.10.2.min.js" type="text/javascript"></script> 
		<script src="${resRoot}/media/odstl/js/jquery-migrate-1.2.1.min.js" type="text/javascript"></script> 
		<script src="${resRoot}/media/odstl/js/bootstrap.min.js" type="text/javascript"></script> 
		<script src="${resRoot}/media/odstl/js/twitter-bootstrap-hover-dropdown.min.js" type="text/javascript"></script> 
		<script src="${resRoot}/media/odstl/js/jquery.cokie.min.js" type="text/javascript"></script> 
		<script src="${resRoot}/media/odstl/js/jquery.uniform.min.js" type="text/javascript"></script> 
		<script src="${resRoot}/media/odstl/js/select2.min.js" type="text/javascript" ></script> 
		<script src="${resRoot}/media/odstl/js/jquery.dataTables.js" type="text/javascript" ></script> 
		<script src="${resRoot}/media/odstl/js/DT_bootstrap.js" type="text/javascript" ></script> 
		<script src="${resRoot}/media/odstl/js/bootstrap-datepicker.js" type="text/javascript" ></script> 
		<script src="${resRoot}/media/odstl/js/bootstrap-datepicker.zh-CN.js" type="text/javascript" ></script> 
		<script src="${resRoot}/media/odstl/js/jquery.ui.widget.js" type="text/javascript" ></script>
		<script src="${resRoot}/media/odstl/js/jquery.iframe-transport.js" type="text/javascript" ></script>
		<script src="${resRoot}/media/odstl/js/jquery.fileupload.js" type="text/javascript" ></script>
		<script src="${resRoot}/media/odstl/js/jquery.fileupload-process.js" type="text/javascript" ></script>
		<script src="${resRoot}/media/odstl/js/jquery.fileupload-validate.js" type="text/javascript" ></script>
		<script src="${resRoot}/media/odstl/js/alert_message.js" type="text/javascript"></script>
		<script src="${resRoot}/media/odstl/js/app.js" type="text/javascript"></script>
		<script src="${resRoot}/media/odstl/js/index.js" type="text/javascript"></script>
		<script src="${resRoot}/media/odstl/js/global.js" type="text/javascript"></script>
		<script src="${resRoot}/media/odstl/js/Date.js" type="text/javascript"></script>
		
	</head>
	<!-- END HEAD -->
	<!-- BEGIN BODY -->
	<body class="header-fixed-body" >
	<!-- BEGIN CONTENT -->
	<div class="page-content-wrapper">
		<div class="page-content">
			 <!-- 面包线start  -->
                <div class="row">
					  <div class="col-md-12">
					    <h3 class="page-title">问卷问题</h3>
					    <ul class="page-breadcrumb breadcrumb">
					            <li>
					                <i class="fa fa-home"></i>
					                <a href="#">首页</a>
					                <i class="fa fa-angle-right"></i>
					            </li>
					            <li>
					                <i class="fa fa-book"></i>
					                <a href="#">问卷管理</a>
					            </li>
					        </ul>
					  </div>
				</div>
				<!-- 面包线start  -->
			<!-- END PAGE HEADER-->
			<form id="requestInfoForm" action="" >
					<!-- BEGIN PAGE MAIN -->
					<div class="portlet box blue">
						<div class="portlet-title">
							<div class="caption">
								问题信息
							</div>
						</div>
						<div class="portlet-body">
							<ul class="nav nav-tabs">
								<li id="titOne" class="active" >
									<a href="#tab_1_1" data-toggle="tab">问题修改</a>
								</li>
							</ul> 
							<div class="tab-content">
								<div class="tab-pane fade active in" id="tab_1_1">
									<div class="form-horizontal clearfix custom-form">
										<div class="row">
											<div class="form-group">
												<label class="col-md-2 control-label text-right">问卷标题:</label>
												<div class="col-md-7">
													<input name="shortName" id="shortName" type="text" class="form-control" value = "${quePro.shortName?if_exists}" />
												    <input name="id" id="id" type="hidden" class="form-control" value = "${quePro.id?if_exists}" />
												</div>
											</div>
										</div>
										<div class="clearfix"></div>
										<div class="row">
											<div class="form-group">
												<label class="col-md-2 control-label text-right">问题序号:</label>
												<div class="col-md-7">
													<input id="code" name="code" type="text" class="form-control" value = "${quePro.code?if_exists}" />
												</div>
												
											</div>
										</div>
										<div class="clearfix"></div>
										<div class="row">
											<div class="form-group">
										       <label class="col-md-2 control-label text-right">题型:</label>
												<div class="col-md-2">
													<select  id="type"  name="type" class="form-control " tabindex="-1">
													    <option value="400011009" <#if quePro.type?if_exists==400011009> selected="selected" </#if> >单选</option>
														<option value="400011001" <#if quePro.type?if_exists==400011001> selected="selected" </#if> >单选文本</option>
														<option value="400011002" <#if quePro.type?if_exists==400011002> selected="selected" </#if> >多选</option>
														<option value="400011003" <#if quePro.type?if_exists==400011003> selected="selected" </#if> >文本</option>
														<option value="400011004" <#if quePro.type?if_exists==400011004> selected="selected" </#if> >下拉 </option>
													    
													</select>
												</div>
												 <label class="col-md-2 control-label text-right">是否必填:</label>
												<div class="checkbox col-md-4">
													    <label class="radio-inline"><input type="radio" <#if quePro.isRequired?if_exists==10000> checked="checked"</#if> name="isRequired" value="10000" />否</label>
														<label class="radio-inline"><input type="radio" <#if quePro.isRequired?if_exists==10001> checked="checked"</#if> name="isRequired" value="10001" />是</label>
												</div>
											</div>
											
										</div>
										<div class="clearfix"></div>
										<div class="row">
											<div class="form-group">
												<label class="col-md-2 control-label text-right">问卷问题:</label>
												<div class="col-md-10">
													<textarea style="font-size:11px;" name="fullName" id="fullName" type="text"  class="form-control" rows="6" >${quePro.fullName}</textarea>
													<span style="color:red;font-size:12px;">友情提醒：录入”请问你是**先生吗？“，点击◎姓名后再输入“先生吗？”</span>
												</div>
												
											</div>
										</div>
										<div class="clearfix"></div>
										
									</div>
									</div>
									
								 
							</div>
						</div>
					</div>
				</form>
			<!-- END PAGE MAIN -->
			<div class="clearfix"></div>
			<div class="col-md-12" style="text-align: center;">
				<div class="btn-group">
				     <input onclick="backButton()" type="button" class="btn gary" value="返回" />
				</div>
				<div class="btn-group">
					<a type="button" onclick="updateQueProButton()"
						class="btn blue"> 确定
					</a>
				</div>
			</div>
		    <div class="clearfix"></div>
		</div>
	</div>
	<br/><br/>
	<!-- END CONTENT -->
	<!-- 弹出配置客户基本信息窗口 -->
	<div class="modal fade" id="myModalrw1" data-backdrop="static" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"></div>
	<!-- JAVASCRIPTS -->
	
	<script type="text/javascript">
		admin = {

		};
		/**  初始化  */
		$(function(){
			$("select").select2();
			App.init();
		});

		/**  返回  */
		function backButton() {
			 window.location.href = "${request.contextPath}/survey/que/gotoQueManageProblem?id="+${quePro.questionnaireId?if_exists};
		}

		/**  问题序号验证  */
		function updateQueProButton() {
			//获取code
			var newQueProCode=$("#code").val();
			var queProCode=${quePro.code?if_exists};
			//验证code是否更换，如果更换，需要查询新的更换是否重复
			if(queProCode==newQueProCode){
				mergeQueProButton();
			}else{
				$.post("${request.contextPath}/survey/que/queryQuestionnaireProblemOrCode",{
					code : $("#code").val(),
					questionnaireId : ${quePro.questionnaireId?if_exists}
				}, function(data) {
					if (data) {
						mergeQueProButton();
					} else {
						$.Alert("添加失败,问卷编号有重复!");
					}
				});
			}
		}

		/**  确定 */
	    function mergeQueProButton(){
	    	//获取参数,
			var shortName = $("#shortName").val();
			var fullName = $("#fullName").val();
			var code = $("#code").val();
			var type = $("#type").val();
			if (shortName == "" || fullName == "" || code == "" || type == "") {
				$.Alert("选项不能为空!");
				return;
			}
			$.ajax({
				url : "${request.contextPath}/survey/que/mergeQuestionnaireProblem",
				type : "post",
				dataType : "json",
				data : $("#requestInfoForm").serialize(),
				success : function(data) {
				    if(data){
				    	$.Alert("修改成功！！！");
				    	backButton();
					}else{
						$.Alert("修改失败！！!");
					}
					
				}
			});
		}

	</script>
	<!-- END JAVASCRIPTS -->
</body>
<!-- END BODY -->
</html>
